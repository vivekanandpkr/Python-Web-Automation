import openpyxl
import time
my_book = openpyxl.load_workbook('Batch1.xlsx')
my_sheet = my_book.get_sheet_by_name('Datasheet')
t_row = my_sheet.max_row + 1
my_list = range(2,t_row)

from selenium import webdriver
import time
driver = webdriver.Chrome("C:\\Users\\Analytics\\Python\\chromedriver\\chromedriver.exe")
driver.maximize_window()
driver.implicitly_wait(15)
driver.get("http:\\www.google.com")

for num in my_list:
    try:
        customer_name = my_sheet.cell(row=num,column=1).value
        driver.get("https://www.google.co.in/search?q=" + customer_name)
        time.sleep(2)
        ans = driver.find_element_by_xpath("//div [@class = '_NId'][1]//span [@class='st']//em[1]")
        data1 = ans.get_attribute('innerHTML')
        my_sheet.cell(row=num,column=2).value = data1
        time.sleep(1)
    except:
        continue

my_book.save('Updated3.xlsx')
print(t_row)
